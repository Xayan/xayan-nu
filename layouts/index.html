<!DOCTYPE html>
{{- $defaultColor := .Site.Params.defaultColor | default "auto" -}}

{{/* allow website developer to enforce default dark mode */}}
{{- if eq $defaultColor "dark" -}}
<html lang="{{ .Site.LanguageCode }}" class="dark">
{{- else if eq $defaultColor "light" -}}
<html lang="{{ .Site.LanguageCode }}" class="light">
{{- else -}}
<html lang="{{ .Site.LanguageCode }}">
{{- end -}}

{{- partial "head.html" . -}}

<body data-theme="{{ $defaultColor }}" class="notransition">
    {{- partial "scriptsBodyStart.html" . -}}
    {{- partial "header.html" . -}}
    <div class="wrapper">
        {{ partial "bio" . }}
        <main class="page-content" aria-label="Content">
            <h2 class="center" aria-label="Recent Posts">Recent Posts</h2>

            {{/* collect posts from main sections, excluding hidden */}}
            {{- $pagesToShow := where .Site.RegularPages "Type" "in" site.Params.mainSections -}}
            {{- $pagesToShow = where $pagesToShow "Params.hidden" "ne" true -}}

            {{/* Show last 5 posts in reverse date order */}}
            {{- $posts := $pagesToShow.ByDate.Reverse -}}
            {{- range $index, $page := first 5 $posts -}}
                {{ partial "postCard" (dict "Page" $page "Index" $index) }}
            {{- end -}}

            {{- if gt (len $posts) 5 -}}
            <p style="text-align: center;">
                {{- range $firstSection := (where .Site.Sections "Section" "in" (first 1 (.Site.Params.mainSections))) -}}
                    <a href="{{ $firstSection.Permalink }}">See all posts ({{ len $posts }})</a>
                {{- end -}}
            </p>
            {{- end -}}
        </main>
    </div>
    {{- partial "footer.html" . -}}
    {{- partial "scriptsBodyEnd.html" . -}}
</body>
</html>
